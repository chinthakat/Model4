2025-06-22 21:34:59 - __main__ - INFO - Initialized MemoryEfficientTrainingManager
2025-06-22 21:34:59 - data.setup_data - INFO - Initialized DataProcessor with lookback_window=20
2025-06-22 21:34:59 - __main__ - INFO - Memory usage Initialization: 460.4 MB (2.9%)
2025-06-22 21:34:59 - __main__ - INFO - MemoryEfficientTrainingManager initialized.
2025-06-22 21:34:59 - __main__ - INFO - Starting memory-efficient training pipeline
2025-06-22 21:34:59 - __main__ - INFO - Initializing streaming reader for: .\data\processed\BINANCEFTS_PERP_BTC_USDT_15m_2024-01-01_to_2025-04-01_consolidated.csv
2025-06-22 21:34:59 - __main__ - INFO - Analyzed file: 43837 rows, columns: ['_temp_index', 'open', 'high', 'low', 'close', 'volume', 'timestamp']
2025-06-22 21:34:59 - __main__ - INFO - StreamingDataReader initialized for file: data\processed\BINANCEFTS_PERP_BTC_USDT_15m_2024-01-01_to_2025-04-01_consolidated.csv
2025-06-22 21:34:59 - __main__ - INFO - File contains 43837 rows, 7 columns
2025-06-22 21:34:59 - __main__ - INFO - Data file info: 43837 rows, 7 columns
2025-06-22 21:34:59 - __main__ - INFO - Starting Episode 1/1
2025-06-22 21:34:59 - __main__ - INFO - Starting new episode iteration through 43837 rows
2025-06-22 21:34:59 - data.setup_data - INFO - Starting complete data preparation pipeline...
2025-06-22 21:34:59 - data.setup_data - INFO - Adding technical indicators...
2025-06-22 21:34:59 - data.setup_data - INFO - Added technical indicators. Shape: (1000, 34)
2025-06-22 21:34:59 - data.setup_data - INFO - Adding futures-specific features...
2025-06-22 21:34:59 - data.setup_data - INFO - No funding rate data available - skipping funding rate features
2025-06-22 21:34:59 - data.setup_data - INFO - Added futures-specific features
2025-06-22 21:34:59 - data.setup_data - INFO - Added time-based features
2025-06-22 21:34:59 - data.setup_data - INFO - Split data: Train 800 rows, Test 200 rows
2025-06-22 21:34:59 - data.setup_data - INFO - Normalizing data (fit_scaler=True)...
2025-06-22 21:34:59 - data.setup_data - INFO - Data normalization completed
2025-06-22 21:34:59 - data.setup_data - INFO - Normalizing data (fit_scaler=False)...
2025-06-22 21:34:59 - data.setup_data - INFO - Data normalization completed
2025-06-22 21:34:59 - data.setup_data - INFO - Data preparation completed. Train: (751, 46), Test: (200, 46)
2025-06-22 21:34:59 - __main__ - INFO - Scalers fitted on first batch
2025-06-22 21:34:59 - __main__ - INFO - Using ULTRA_SMALL_TRANSACTION_CONFIG for reward system.
2025-06-22 21:34:59 - __main__ - INFO - Creating training environment for the first time...
2025-06-22 21:34:59 - utils.trade_logger - INFO - Initialized TradeLogger: logs\trades\training_trades.csv
2025-06-22 21:34:59 - utils.trade_logger - INFO - Session initialized with starting balance: $10000.00
2025-06-22 21:34:59 - environment - INFO - Trade logger initialized with session: training_session_ep001_batch001
2025-06-22 21:34:59 - utils.trade_tracer - INFO - Initialized TradeTracer. JSONL traces in: logs\trade_traces\trade_traces.jsonl. Text logs in: logs\trade_tracer.log
2025-06-22 21:34:59 - environment - INFO - Trade tracer initialized: training_session_ep001_batch001_traces
2025-06-22 21:34:59 - environment - INFO - DataFrame shape: (751, 46)
2025-06-22 21:34:59 - environment - INFO - DataFrame columns: ['Open', 'High', 'Low', 'Close', 'Volume', 'MACD_12_26_9', 'MACDh_12_26_9', 'MACDs_12_26_9', 'RSI', 'SMA_20', 'SMA_50', 'EMA_12', 'EMA_26', 'BBL_20_2.0', 'BBM_20_2.0', 'BBU_20_2.0', 'BBB_20_2.0', 'BBP_20_2.0', 'ATR', 'STOCHk_14_3_3', 'STOCHd_14_3_3', 'WillR', 'CCI', 'Volume_SMA', 'Volume_Ratio', 'Price_Change', 'Price_Change_SMA', 'Volatility', 'High_20', 'Low_20', 'Gap_Up', 'Gap_Down', 'Doji', 'Hammer', 'hour', 'day_of_week', 'day_of_month', 'month', 'hour_sin', 'hour_cos', 'dow_sin', 'dow_cos', 'is_asian_session', 'is_european_session', 'is_american_session', 'is_weekend']
2025-06-22 21:34:59 - environment - INFO - Feature columns: ['Open', 'High', 'Low', 'Close', 'Volume', 'MACD_12_26_9', 'MACDh_12_26_9', 'MACDs_12_26_9', 'RSI', 'SMA_20', 'SMA_50', 'EMA_12', 'EMA_26', 'BBL_20_2.0', 'BBM_20_2.0', 'BBU_20_2.0', 'BBB_20_2.0', 'BBP_20_2.0', 'ATR', 'STOCHk_14_3_3', 'STOCHd_14_3_3', 'WillR', 'CCI', 'Volume_SMA', 'Volume_Ratio', 'Price_Change', 'Price_Change_SMA', 'Volatility', 'High_20', 'Low_20', 'Gap_Up', 'Gap_Down', 'Doji', 'Hammer', 'hour', 'day_of_week', 'day_of_month', 'month', 'hour_sin', 'hour_cos', 'dow_sin', 'dow_cos', 'is_asian_session', 'is_european_session', 'is_american_session', 'is_weekend']
2025-06-22 21:34:59 - environment - INFO - Number of feature columns: 46
2025-06-22 21:34:59 - environment - INFO - Lookback window: 20
2025-06-22 21:34:59 - environment - INFO - Max steps: 731
2025-06-22 21:34:59 - environment - INFO - Market features size: 920 (46 x 20)
2025-06-22 21:34:59 - environment - INFO - Account features size: 7
2025-06-22 21:34:59 - environment - INFO - Individual trades features size: 20 (5 trades x 4 features)
2025-06-22 21:34:59 - environment - INFO - Total observation size: 947
2025-06-22 21:34:59 - environment - INFO - Using discrete action space with individual trade management:
2025-06-22 21:34:59 - environment - INFO -   - Actions 0-2: HOLD, BUY, SELL
2025-06-22 21:34:59 - environment - INFO -   - Actions 3-7: CLOSE_TRADE_1 to CLOSE_TRADE_5
2025-06-22 21:34:59 - environment - INFO -   - 8 position sizes: [0.0, 0.005, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06]
2025-06-22 21:34:59 - environment - INFO - Environment initialized with observation space: (947,)
2025-06-22 21:34:59 - __main__ - INFO - Training environment created successfully.
2025-06-22 21:34:59 - __main__ - INFO - Creating test environment for the first time...
2025-06-22 21:34:59 - utils.trade_logger - INFO - Initialized TradeLogger: logs\trades\testing_trades.csv
2025-06-22 21:34:59 - utils.trade_logger - INFO - Session initialized with starting balance: $10000.00
2025-06-22 21:34:59 - environment - INFO - Trade logger initialized with session: testing_session_ep001_batch001
2025-06-22 21:34:59 - utils.trade_tracer - INFO - Initialized TradeTracer. JSONL traces in: logs\trade_traces\trade_traces.jsonl. Text logs in: logs\trade_tracer.log
2025-06-22 21:34:59 - environment - INFO - Trade tracer initialized: testing_session_ep001_batch001_traces
2025-06-22 21:34:59 - environment - INFO - DataFrame shape: (200, 46)
2025-06-22 21:34:59 - environment - INFO - DataFrame columns: ['Open', 'High', 'Low', 'Close', 'Volume', 'MACD_12_26_9', 'MACDh_12_26_9', 'MACDs_12_26_9', 'RSI', 'SMA_20', 'SMA_50', 'EMA_12', 'EMA_26', 'BBL_20_2.0', 'BBM_20_2.0', 'BBU_20_2.0', 'BBB_20_2.0', 'BBP_20_2.0', 'ATR', 'STOCHk_14_3_3', 'STOCHd_14_3_3', 'WillR', 'CCI', 'Volume_SMA', 'Volume_Ratio', 'Price_Change', 'Price_Change_SMA', 'Volatility', 'High_20', 'Low_20', 'Gap_Up', 'Gap_Down', 'Doji', 'Hammer', 'hour', 'day_of_week', 'day_of_month', 'month', 'hour_sin', 'hour_cos', 'dow_sin', 'dow_cos', 'is_asian_session', 'is_european_session', 'is_american_session', 'is_weekend']
2025-06-22 21:34:59 - environment - INFO - Feature columns: ['Open', 'High', 'Low', 'Close', 'Volume', 'MACD_12_26_9', 'MACDh_12_26_9', 'MACDs_12_26_9', 'RSI', 'SMA_20', 'SMA_50', 'EMA_12', 'EMA_26', 'BBL_20_2.0', 'BBM_20_2.0', 'BBU_20_2.0', 'BBB_20_2.0', 'BBP_20_2.0', 'ATR', 'STOCHk_14_3_3', 'STOCHd_14_3_3', 'WillR', 'CCI', 'Volume_SMA', 'Volume_Ratio', 'Price_Change', 'Price_Change_SMA', 'Volatility', 'High_20', 'Low_20', 'Gap_Up', 'Gap_Down', 'Doji', 'Hammer', 'hour', 'day_of_week', 'day_of_month', 'month', 'hour_sin', 'hour_cos', 'dow_sin', 'dow_cos', 'is_asian_session', 'is_european_session', 'is_american_session', 'is_weekend']
2025-06-22 21:34:59 - environment - INFO - Number of feature columns: 46
2025-06-22 21:34:59 - environment - INFO - Lookback window: 20
2025-06-22 21:34:59 - environment - INFO - Max steps: 180
2025-06-22 21:34:59 - environment - INFO - Market features size: 920 (46 x 20)
2025-06-22 21:34:59 - environment - INFO - Account features size: 7
2025-06-22 21:34:59 - environment - INFO - Individual trades features size: 20 (5 trades x 4 features)
2025-06-22 21:34:59 - environment - INFO - Total observation size: 947
2025-06-22 21:34:59 - environment - INFO - Using discrete action space with individual trade management:
2025-06-22 21:34:59 - environment - INFO -   - Actions 0-2: HOLD, BUY, SELL
2025-06-22 21:34:59 - environment - INFO -   - Actions 3-7: CLOSE_TRADE_1 to CLOSE_TRADE_5
2025-06-22 21:34:59 - environment - INFO -   - 8 position sizes: [0.0, 0.005, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06]
2025-06-22 21:34:59 - environment - INFO - Environment initialized with observation space: (947,)
2025-06-22 21:34:59 - __main__ - INFO - Test environment created successfully.
2025-06-22 21:34:59 - __main__ - INFO - Creating new TradingModel (will be reused for all episodes and batches)...
2025-06-22 21:34:59 - model - INFO - Initializing TradingModel: memory_efficient_model_20250622_213459
2025-06-22 21:34:59 - model - INFO - TensorBoard logging: Enabled
2025-06-22 21:35:00 - model - INFO - Created PPO model on device: cuda
2025-06-22 21:35:00 - model - INFO - Model parameters initialized with small values
2025-06-22 21:35:00 - model - INFO - Successfully initialized TradingModel: memory_efficient_model_20250622_213459
2025-06-22 21:35:00 - __main__ - INFO - TradingModel created successfully. This model will be reused throughout training.
2025-06-22 21:35:00 - model - INFO - Starting training for 10000 timesteps
2025-06-22 21:35:05 - environment - INFO - Episode reset: 731 steps completed
2025-06-22 21:35:10 - environment - INFO - Episode reset: 731 steps completed
2025-06-22 21:35:10 - environment - INFO - Opened LONG trade: 0.001000 BTC at $69017.53 (ID: TRADE_00000)
2025-06-22 21:35:10 - utils.trade_tracer - DEBUG - Trace event 'TRADE_OPENED' written for trade TRADE_00000
2025-06-22 21:35:10 - utils.trade_tracer - INFO - Trade opened: TRADE_00000 - LONG 0.001000 BINANCEFTS_PERP_BTC_USDT @ 69017.53
2025-06-22 21:35:10 - environment - INFO - BUY executed: 0.001000 BTC at $69017.53
2025-06-22 21:35:15 - environment - INFO - Episode reset: 731 steps completed
2025-06-22 21:35:20 - environment - INFO - Episode reset: 731 steps completed
2025-06-22 21:35:27 - environment - INFO - Episode reset: 731 steps completed
2025-06-22 21:35:32 - environment - INFO - Episode reset: 731 steps completed
2025-06-22 21:35:38 - environment - INFO - Episode reset: 731 steps completed
2025-06-22 21:35:44 - environment - INFO - Episode reset: 731 steps completed
2025-06-22 21:35:49 - environment - INFO - Episode reset: 731 steps completed
2025-06-22 21:35:55 - environment - INFO - Episode reset: 731 steps completed
2025-06-22 21:35:59 - environment - INFO - Episode reset: 731 steps completed
2025-06-22 21:36:04 - environment - INFO - Episode reset: 731 steps completed
2025-06-22 21:36:08 - environment - INFO - Episode reset: 731 steps completed
2025-06-22 21:36:13 - environment - INFO - Episode reset: 731 steps completed
2025-06-22 21:36:13 - model - INFO - Training completed. Model saved to models\memory_efficient_model_20250622_213459_final
2025-06-22 21:36:13 - model - INFO - Evaluating model for 1 episodes
2025-06-22 21:36:14 - model - INFO - Evaluation completed. Mean reward: -0.09
2025-06-22 21:36:14 - data.setup_data - INFO - Starting complete data preparation pipeline...
2025-06-22 21:36:14 - data.setup_data - INFO - Adding technical indicators...
2025-06-22 21:36:14 - data.setup_data - INFO - Added technical indicators. Shape: (2000, 34)
2025-06-22 21:36:14 - data.setup_data - INFO - Adding futures-specific features...
2025-06-22 21:36:14 - data.setup_data - INFO - No funding rate data available - skipping funding rate features
2025-06-22 21:36:14 - data.setup_data - INFO - Added futures-specific features
2025-06-22 21:36:14 - data.setup_data - INFO - Added time-based features
2025-06-22 21:36:14 - data.setup_data - INFO - Split data: Train 1600 rows, Test 400 rows
2025-06-22 21:36:14 - data.setup_data - INFO - Normalizing data (fit_scaler=True)...
2025-06-22 21:36:14 - data.setup_data - INFO - Data normalization completed
2025-06-22 21:36:14 - data.setup_data - INFO - Normalizing data (fit_scaler=False)...
2025-06-22 21:36:14 - data.setup_data - INFO - Data normalization completed
2025-06-22 21:36:14 - data.setup_data - INFO - Data preparation completed. Train: (1551, 46), Test: (400, 46)
2025-06-22 21:36:14 - __main__ - INFO - Using ULTRA_SMALL_TRANSACTION_CONFIG for reward system.
2025-06-22 21:36:14 - environment - INFO - Episode reset: 6 steps completed
2025-06-22 21:36:14 - environment - INFO - Environment data updated - Episode 1, Batch 2, 1551 steps
2025-06-22 21:36:14 - environment - INFO - Episode reset: 180 steps completed
2025-06-22 21:36:14 - environment - INFO - Environment data updated - Episode 1, Batch 2, 400 steps
2025-06-22 21:36:14 - model - INFO - Starting training for 10000 timesteps
2025-06-22 21:36:26 - environment - INFO - Episode reset: 1530 steps completed
