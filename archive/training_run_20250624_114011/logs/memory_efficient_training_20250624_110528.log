2025-06-24 11:05:28 - __main__ - INFO - Initialized MemoryEfficientTrainingManager
2025-06-24 11:05:28 - data.setup_data - INFO - Initialized DataProcessor with lookback_window=20
2025-06-24 11:05:28 - __main__ - INFO - Memory usage Initialization: 461.8 MB (2.9%)
2025-06-24 11:05:28 - __main__ - INFO - MemoryEfficientTrainingManager initialized.
2025-06-24 11:05:28 - __main__ - INFO - Starting memory-efficient training pipeline
2025-06-24 11:05:28 - __main__ - INFO - Loading entire dataset from .\data\processed\BINANCEFTS_PERP_BTC_USDT_15m_2024-01-01_to_2025-04-01_consolidated.csv for the episode...
2025-06-24 11:05:29 - __main__ - INFO - Loaded 43837 rows.
2025-06-24 11:05:29 - __main__ - INFO - Starting Episode 1/1
2025-06-24 11:05:29 - __main__ - INFO - Initializing streaming reader for: .\data\processed\BINANCEFTS_PERP_BTC_USDT_15m_2024-01-01_to_2025-04-01_consolidated.csv
2025-06-24 11:05:29 - __main__ - INFO - Analyzed file: 43837 rows, columns: ['_temp_index', 'open', 'high', 'low', 'close', 'volume', 'timestamp']
2025-06-24 11:05:29 - __main__ - INFO - StreamingDataReader initialized for file: data\processed\BINANCEFTS_PERP_BTC_USDT_15m_2024-01-01_to_2025-04-01_consolidated.csv
2025-06-24 11:05:29 - __main__ - INFO - File contains 43837 rows, 7 columns
2025-06-24 11:05:29 - __main__ - INFO - Data file info: 43837 rows, 7 columns
2025-06-24 11:05:29 - data.setup_data - INFO - Starting complete data preparation pipeline...
2025-06-24 11:05:29 - data.setup_data - INFO - Adding technical indicators...
2025-06-24 11:05:29 - data.setup_data - INFO - Added technical indicators. Shape: (43837, 35)
2025-06-24 11:05:29 - data.setup_data - INFO - Adding futures-specific features...
2025-06-24 11:05:29 - data.setup_data - INFO - No funding rate data available - skipping funding rate features
2025-06-24 11:05:29 - data.setup_data - INFO - Added futures-specific features
2025-06-24 11:05:29 - data.setup_data - INFO - Added time-based features
2025-06-24 11:05:29 - data.setup_data - INFO - Split data: Train 35069 rows, Test 8768 rows
2025-06-24 11:05:29 - data.setup_data - INFO - Normalizing data (fit_scaler=True)...
2025-06-24 11:05:29 - data.setup_data - INFO - Data normalization completed
2025-06-24 11:05:29 - data.setup_data - INFO - Normalizing data (fit_scaler=False)...
2025-06-24 11:05:29 - data.setup_data - INFO - Data normalization completed
2025-06-24 11:05:29 - data.setup_data - INFO - Data preparation completed. Train: (35020, 47), Test: (8768, 47)
2025-06-24 11:05:29 - __main__ - INFO - Using ULTRA_SMALL_TRANSACTION_CONFIG for reward system.
2025-06-24 11:05:29 - __main__ - INFO - Creating training environment for the first time...
2025-06-24 11:05:29 - utils.trade_logger - INFO - Initialized TradeLogger: logs\trades\training_trades.csv
2025-06-24 11:05:29 - utils.trade_logger - INFO - Session initialized with starting balance: $10000.00
2025-06-24 11:05:29 - environment - INFO - Trade logger initialized with session: training_session_ep001_batch000
2025-06-24 11:05:29 - utils.trade_tracer - INFO - Initialized TradeTracer. JSONL traces in: logs\trade_traces\trade_traces.jsonl. Text logs in: logs\trade_tracer.log
2025-06-24 11:05:29 - environment - INFO - Trade tracer initialized: training_session_ep001_batch000_traces
2025-06-24 11:05:29 - environment - INFO - DataFrame shape: (35020, 47)
2025-06-24 11:05:29 - environment - INFO - DataFrame columns: ['Unnamed: 0', 'Open', 'High', 'Low', 'Close', 'Volume', 'MACD_12_26_9', 'MACDh_12_26_9', 'MACDs_12_26_9', 'RSI', 'SMA_20', 'SMA_50', 'EMA_12', 'EMA_26', 'BBL_20_2.0', 'BBM_20_2.0', 'BBU_20_2.0', 'BBB_20_2.0', 'BBP_20_2.0', 'ATR', 'STOCHk_14_3_3', 'STOCHd_14_3_3', 'WillR', 'CCI', 'Volume_SMA', 'Volume_Ratio', 'Price_Change', 'Price_Change_SMA', 'Volatility', 'High_20', 'Low_20', 'Gap_Up', 'Gap_Down', 'Doji', 'Hammer', 'hour', 'day_of_week', 'day_of_month', 'month', 'hour_sin', 'hour_cos', 'dow_sin', 'dow_cos', 'is_asian_session', 'is_european_session', 'is_american_session', 'is_weekend']
2025-06-24 11:05:29 - environment - INFO - Feature columns: ['Unnamed: 0', 'Open', 'High', 'Low', 'Close', 'Volume', 'MACD_12_26_9', 'MACDh_12_26_9', 'MACDs_12_26_9', 'RSI', 'SMA_20', 'SMA_50', 'EMA_12', 'EMA_26', 'BBL_20_2.0', 'BBM_20_2.0', 'BBU_20_2.0', 'BBB_20_2.0', 'BBP_20_2.0', 'ATR', 'STOCHk_14_3_3', 'STOCHd_14_3_3', 'WillR', 'CCI', 'Volume_SMA', 'Volume_Ratio', 'Price_Change', 'Price_Change_SMA', 'Volatility', 'High_20', 'Low_20', 'Gap_Up', 'Gap_Down', 'Doji', 'Hammer', 'hour', 'day_of_week', 'day_of_month', 'month', 'hour_sin', 'hour_cos', 'dow_sin', 'dow_cos', 'is_asian_session', 'is_european_session', 'is_american_session', 'is_weekend']
2025-06-24 11:05:29 - environment - INFO - Number of feature columns: 47
2025-06-24 11:05:29 - environment - INFO - Lookback window: 20
2025-06-24 11:05:29 - environment - INFO - Max steps: 35000
2025-06-24 11:05:29 - environment - INFO - Market features size: 940 (47 x 20)
2025-06-24 11:05:29 - environment - INFO - Account features size: 7
2025-06-24 11:05:29 - environment - INFO - Individual trades features size: 20 (5 trades x 4 features)
2025-06-24 11:05:29 - environment - INFO - Total observation size: 967
2025-06-24 11:05:29 - environment - INFO - Using discrete action space with individual trade management:
2025-06-24 11:05:29 - environment - INFO -   - Actions 0-2: HOLD, BUY, SELL
2025-06-24 11:05:29 - environment - INFO -   - Actions 3-7: CLOSE_TRADE_1 to CLOSE_TRADE_5
2025-06-24 11:05:29 - environment - INFO -   - 8 position sizes: [0.0, 0.005, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06]
2025-06-24 11:05:29 - environment - INFO - Environment initialized with observation space: (967,)
2025-06-24 11:05:29 - __main__ - INFO - Training environment created successfully.
2025-06-24 11:05:29 - __main__ - INFO - Creating test environment for the first time...
2025-06-24 11:05:29 - utils.trade_logger - INFO - Initialized TradeLogger: logs\trades\testing_trades.csv
2025-06-24 11:05:29 - utils.trade_logger - INFO - Session initialized with starting balance: $10000.00
2025-06-24 11:05:29 - environment - INFO - Trade logger initialized with session: testing_session_ep001_batch000
2025-06-24 11:05:29 - utils.trade_tracer - INFO - Initialized TradeTracer. JSONL traces in: logs\trade_traces\trade_traces.jsonl. Text logs in: logs\trade_tracer.log
2025-06-24 11:05:29 - environment - INFO - Trade tracer initialized: testing_session_ep001_batch000_traces
2025-06-24 11:05:29 - environment - INFO - DataFrame shape: (8768, 47)
2025-06-24 11:05:29 - environment - INFO - DataFrame columns: ['Unnamed: 0', 'Open', 'High', 'Low', 'Close', 'Volume', 'MACD_12_26_9', 'MACDh_12_26_9', 'MACDs_12_26_9', 'RSI', 'SMA_20', 'SMA_50', 'EMA_12', 'EMA_26', 'BBL_20_2.0', 'BBM_20_2.0', 'BBU_20_2.0', 'BBB_20_2.0', 'BBP_20_2.0', 'ATR', 'STOCHk_14_3_3', 'STOCHd_14_3_3', 'WillR', 'CCI', 'Volume_SMA', 'Volume_Ratio', 'Price_Change', 'Price_Change_SMA', 'Volatility', 'High_20', 'Low_20', 'Gap_Up', 'Gap_Down', 'Doji', 'Hammer', 'hour', 'day_of_week', 'day_of_month', 'month', 'hour_sin', 'hour_cos', 'dow_sin', 'dow_cos', 'is_asian_session', 'is_european_session', 'is_american_session', 'is_weekend']
2025-06-24 11:05:29 - environment - INFO - Feature columns: ['Unnamed: 0', 'Open', 'High', 'Low', 'Close', 'Volume', 'MACD_12_26_9', 'MACDh_12_26_9', 'MACDs_12_26_9', 'RSI', 'SMA_20', 'SMA_50', 'EMA_12', 'EMA_26', 'BBL_20_2.0', 'BBM_20_2.0', 'BBU_20_2.0', 'BBB_20_2.0', 'BBP_20_2.0', 'ATR', 'STOCHk_14_3_3', 'STOCHd_14_3_3', 'WillR', 'CCI', 'Volume_SMA', 'Volume_Ratio', 'Price_Change', 'Price_Change_SMA', 'Volatility', 'High_20', 'Low_20', 'Gap_Up', 'Gap_Down', 'Doji', 'Hammer', 'hour', 'day_of_week', 'day_of_month', 'month', 'hour_sin', 'hour_cos', 'dow_sin', 'dow_cos', 'is_asian_session', 'is_european_session', 'is_american_session', 'is_weekend']
2025-06-24 11:05:29 - environment - INFO - Number of feature columns: 47
2025-06-24 11:05:29 - environment - INFO - Lookback window: 20
2025-06-24 11:05:29 - environment - INFO - Max steps: 8748
2025-06-24 11:05:29 - environment - INFO - Market features size: 940 (47 x 20)
2025-06-24 11:05:29 - environment - INFO - Account features size: 7
2025-06-24 11:05:29 - environment - INFO - Individual trades features size: 20 (5 trades x 4 features)
2025-06-24 11:05:29 - environment - INFO - Total observation size: 967
2025-06-24 11:05:29 - environment - INFO - Using discrete action space with individual trade management:
2025-06-24 11:05:29 - environment - INFO -   - Actions 0-2: HOLD, BUY, SELL
2025-06-24 11:05:29 - environment - INFO -   - Actions 3-7: CLOSE_TRADE_1 to CLOSE_TRADE_5
2025-06-24 11:05:29 - environment - INFO -   - 8 position sizes: [0.0, 0.005, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06]
2025-06-24 11:05:29 - environment - INFO - Environment initialized with observation space: (967,)
2025-06-24 11:05:29 - __main__ - INFO - Test environment created successfully.
2025-06-24 11:05:29 - __main__ - INFO - Creating new TradingModel...
2025-06-24 11:05:29 - model - INFO - Initializing TradingModel: memory_efficient_model_20250624_110529
2025-06-24 11:05:29 - model - INFO - TensorBoard logging: Enabled
2025-06-24 11:05:30 - model - INFO - Created PPO model on device: cuda
2025-06-24 11:05:30 - model - INFO - Model parameters initialized with small values
2025-06-24 11:05:30 - model - INFO - Successfully initialized TradingModel: memory_efficient_model_20250624_110529
2025-06-24 11:05:30 - __main__ - INFO - TradingModel created successfully
2025-06-24 11:05:30 - __main__ - INFO - Training model on current batch for 10000 steps...
2025-06-24 11:05:30 - model - INFO - Starting training for 10000 timesteps
2025-06-24 11:05:39 - environment - INFO - Opened LONG trade: 0.001000 BTC at $51842.28 (ID: TRADE_00000)
2025-06-24 11:05:39 - utils.trade_tracer - DEBUG - Trace event 'TRADE_OPENED' written for trade TRADE_00000
2025-06-24 11:05:39 - utils.trade_tracer - INFO - Trade opened: TRADE_00000 - LONG 0.001000 BINANCEFTS_PERP_BTC_USDT @ 51842.28
2025-06-24 11:05:39 - environment - INFO - BUY executed: 0.001000 BTC at $51842.28
2025-06-24 11:05:47 - environment - INFO - Opened LONG trade: 0.001000 BTC at $51577.62 (ID: TRADE_00001)
2025-06-24 11:05:47 - utils.trade_tracer - DEBUG - Trace event 'TRADE_OPENED' written for trade TRADE_00001
2025-06-24 11:05:47 - utils.trade_tracer - INFO - Trade opened: TRADE_00001 - LONG 0.001000 BINANCEFTS_PERP_BTC_USDT @ 51577.62
2025-06-24 11:05:47 - environment - INFO - BUY executed: 0.001000 BTC at $51577.62
2025-06-24 11:05:47 - environment - INFO - Opened LONG trade: 0.001000 BTC at $51889.32 (ID: TRADE_00002)
2025-06-24 11:05:47 - utils.trade_tracer - DEBUG - Trace event 'TRADE_OPENED' written for trade TRADE_00002
2025-06-24 11:05:47 - utils.trade_tracer - INFO - Trade opened: TRADE_00002 - LONG 0.001000 BINANCEFTS_PERP_BTC_USDT @ 51889.32
2025-06-24 11:05:47 - environment - INFO - BUY executed: 0.001000 BTC at $51889.32
2025-06-24 11:05:52 - environment - INFO - Opened LONG trade: 0.001000 BTC at $51684.37 (ID: TRADE_00003)
2025-06-24 11:05:52 - utils.trade_tracer - DEBUG - Trace event 'TRADE_OPENED' written for trade TRADE_00003
2025-06-24 11:05:52 - utils.trade_tracer - INFO - Trade opened: TRADE_00003 - LONG 0.001000 BINANCEFTS_PERP_BTC_USDT @ 51684.37
2025-06-24 11:05:52 - environment - INFO - BUY executed: 0.001000 BTC at $51684.37
2025-06-24 11:05:57 - environment - INFO - Opened LONG trade: 0.001000 BTC at $54076.72 (ID: TRADE_00004)
2025-06-24 11:05:57 - utils.trade_tracer - DEBUG - Trace event 'TRADE_OPENED' written for trade TRADE_00004
2025-06-24 11:05:57 - utils.trade_tracer - INFO - Trade opened: TRADE_00004 - LONG 0.001000 BINANCEFTS_PERP_BTC_USDT @ 54076.72
2025-06-24 11:05:57 - environment - INFO - BUY executed: 0.001000 BTC at $54076.72
2025-06-24 11:05:58 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:05:58 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:02 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:02 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:04 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:04 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:05 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:05 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:05 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:05 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:06 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:06 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:07 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:07 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:13 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:13 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:18 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:18 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:20 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:20 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:21 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:21 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:30 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:30 - environment - WARNING - SELL rejected: Failed to open short trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:30 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:30 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:30 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:30 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:33 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:33 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:36 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:36 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:36 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:36 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:37 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:37 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:38 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:38 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:38 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:38 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:39 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:39 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:40 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:40 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:40 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:40 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:46 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:46 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:47 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:47 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:48 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:48 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:48 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:48 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:53 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:53 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:54 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:54 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:54 - environment - WARNING - Cannot open new trade: already have 5/5 trades
2025-06-24 11:06:54 - environment - WARNING - BUY rejected: Failed to open long trade (insufficient balance, too many trades, or size too small)
2025-06-24 11:06:57 - model - INFO - Training completed. Model saved to models\memory_efficient_model_20250624_110529_final
2025-06-24 11:06:57 - __main__ - INFO - Model trained on 10000 steps. Total steps trained: 10000
2025-06-24 11:06:57 - __main__ - INFO - Evaluating model on the test set...
2025-06-24 11:06:57 - model - INFO - Evaluating model for 1 episodes
2025-06-24 11:08:13 - model - INFO - Evaluation completed. Mean reward: 43.25
2025-06-24 11:08:13 - __main__ - INFO - Evaluation completed. Mean reward: 43.2519
2025-06-24 11:08:13 - __main__ - INFO - Episode 1 completed. Total steps trained: 10000
2025-06-24 11:08:13 - __main__ - INFO - Training pipeline finished.
2025-06-24 11:08:13 - model - INFO - Model saved to models/memory_efficient_model_final
2025-06-24 11:08:13 - __main__ - INFO - Final model saved to models/memory_efficient_model_final
2025-06-24 11:08:13 - __main__ - INFO - Starting cleanup process...
2025-06-24 11:08:13 - __main__ - INFO - Closing train environment trade logger...
2025-06-24 11:08:13 - __main__ - INFO - Closing train environment trade tracer...
2025-06-24 11:08:13 - __main__ - INFO - Closing test environment trade logger...
2025-06-24 11:08:13 - __main__ - INFO - Closing test environment trade tracer...
2025-06-24 11:08:13 - __main__ - INFO - Closing logging handlers...
